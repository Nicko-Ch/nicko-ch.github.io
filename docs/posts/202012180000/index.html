<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Go基础语法 | &gt; $ cd /home</title>
<meta name="keywords" content="Go" />
<meta name="description" content="array 数组 声明方式
var identifier [len]type // var arr [5]int  var arrAge = [5]int{18, 20, 15, 22, 16} // 声明容量为5的数组并初始化 var arrLazy = [...]int{5, 6, 7, 8, 22} // 初始化数组自动计算容量（实际上已是切片） var arrLazy = []int{5, 6, 7, 8, 22}	// 初始化得到的实际上是切片slice var arrKeyValue = [5]string{3: &#34;Chris&#34;, 4: &#34;Ron&#34;} // 0,1,2 都未空值 var arrKeyValue = []string{3: &#34;Chris&#34;, 4: &#34;Ron&#34;}	// 初始化得到的实际上是切片slice  slice 切片 本质
不是一组数组的指针，是一种数据结构，用来操作内部元素。
切片名称 [low : high : max] low: 起始下标位置 high: 结束下标位置 len = high - low max: 容量 cap = max - low 声明方式">
<meta name="author" content="">
<link rel="canonical" href="https://nicko-ch.github.io/posts/202012180000/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.0459a4ebf56f381ae411e97a494635ba7ce9db741ff9a2cfbf7e12366bf1e73d.css" integrity="sha256-BFmk6/VvOBrkEel6SUY1unzp23Qf&#43;aLPv34SNmvx5z0=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.6f62d19b78590241c3e007a10f91f45f95ce2528ca8f3e33c542e95f8ed5691f.js" integrity="sha256-b2LRm3hZAkHD4AehD5H0X5XOJSjKjz4zxULpX47VaR8="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://nicko-ch.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://nicko-ch.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://nicko-ch.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://nicko-ch.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://nicko-ch.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.88.0" />
<meta property="og:title" content="Go基础语法" />
<meta property="og:description" content="array 数组 声明方式
var identifier [len]type // var arr [5]int  var arrAge = [5]int{18, 20, 15, 22, 16} // 声明容量为5的数组并初始化 var arrLazy = [...]int{5, 6, 7, 8, 22} // 初始化数组自动计算容量（实际上已是切片） var arrLazy = []int{5, 6, 7, 8, 22}	// 初始化得到的实际上是切片slice var arrKeyValue = [5]string{3: &#34;Chris&#34;, 4: &#34;Ron&#34;} // 0,1,2 都未空值 var arrKeyValue = []string{3: &#34;Chris&#34;, 4: &#34;Ron&#34;}	// 初始化得到的实际上是切片slice  slice 切片 本质
不是一组数组的指针，是一种数据结构，用来操作内部元素。
切片名称 [low : high : max] low: 起始下标位置 high: 结束下标位置 len = high - low max: 容量 cap = max - low 声明方式" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nicko-ch.github.io/posts/202012180000/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-18T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2020-12-18T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Go基础语法"/>
<meta name="twitter:description" content="array 数组 声明方式
var identifier [len]type // var arr [5]int  var arrAge = [5]int{18, 20, 15, 22, 16} // 声明容量为5的数组并初始化 var arrLazy = [...]int{5, 6, 7, 8, 22} // 初始化数组自动计算容量（实际上已是切片） var arrLazy = []int{5, 6, 7, 8, 22}	// 初始化得到的实际上是切片slice var arrKeyValue = [5]string{3: &#34;Chris&#34;, 4: &#34;Ron&#34;} // 0,1,2 都未空值 var arrKeyValue = []string{3: &#34;Chris&#34;, 4: &#34;Ron&#34;}	// 初始化得到的实际上是切片slice  slice 切片 本质
不是一组数组的指针，是一种数据结构，用来操作内部元素。
切片名称 [low : high : max] low: 起始下标位置 high: 结束下标位置 len = high - low max: 容量 cap = max - low 声明方式"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://nicko-ch.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Go基础语法",
      "item": "https://nicko-ch.github.io/posts/202012180000/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Go基础语法",
  "name": "Go基础语法",
  "description": "array 数组 声明方式\nvar identifier [len]type // var arr [5]int  var arrAge = [5]int{18, 20, 15, 22, 16} // 声明容量为5的数组并初始化 var arrLazy = [...]int{5, 6, 7, 8, 22} // 初始化数组自动计算容量（实际上已是切片） var arrLazy = []int{5, 6, 7, 8, 22}\t// 初始化得到的实际上是切片slice var arrKeyValue = [5]string{3: \u0026#34;Chris\u0026#34;, 4: \u0026#34;Ron\u0026#34;} // 0,1,2 都未空值 var arrKeyValue = []string{3: \u0026#34;Chris\u0026#34;, 4: \u0026#34;Ron\u0026#34;}\t// 初始化得到的实际上是切片slice  slice 切片 本质\n不是一组数组的指针，是一种数据结构，用来操作内部元素。\n切片名称 [low : high : max] low: 起始下标位置 high: 结束下标位置 len = high - low max: 容量 cap = max - low 声明方式",
  "keywords": [
    "Go"
  ],
  "articleBody": "array 数组 声明方式\nvar identifier [len]type // var arr [5]int  var arrAge = [5]int{18, 20, 15, 22, 16} // 声明容量为5的数组并初始化 var arrLazy = [...]int{5, 6, 7, 8, 22} // 初始化数组自动计算容量（实际上已是切片） var arrLazy = []int{5, 6, 7, 8, 22}\t// 初始化得到的实际上是切片slice var arrKeyValue = [5]string{3: \"Chris\", 4: \"Ron\"} // 0,1,2 都未空值 var arrKeyValue = []string{3: \"Chris\", 4: \"Ron\"}\t// 初始化得到的实际上是切片slice  slice 切片 本质\n不是一组数组的指针，是一种数据结构，用来操作内部元素。\n切片名称 [low : high : max] low: 起始下标位置 high: 结束下标位置 len = high - low max: 容量 cap = max - low 声明方式\nvar slice []type = arr[start:end] // 已存在arr数组时  var slice []type = make([]type, len) // 未生成数组时用make声明 var slice1 := make([]type, len) // 同上，简写  var s2 := make([]int, 10) // cap(s2) == len(s2) == 10  // make 函数参数 func make([]T, len, cap) 基本元素\n 数组与切片定义区别  创建数组时 [n] 指定数组长度 创建切片时 [] 为空，或者...\n  字符串与切片 内存结构\n修改字符串中的某个字符\n例如，将字符串 “hello” 转换为 “cello”：\ns := \"hello\" c := []byte(s) c[0] = 'c' s2 := string(c) // s2 == \"cello\"  append函数常用操作 我们在第 7.5 节提到的 append 非常有用，它能够用于各种方面的操作：\n  将切片 b 的元素追加到切片 a 之后：a = append(a, b...)\n  复制切片 a 的元素到新的切片 b 上：\nb = make([]T, len(a))\rcopy(b, a)\n  删除位于索引 i 的元素：a = append(a[:i], a[i+1:]...)\n  切除切片 a 中从索引 i 至 j 位置的元素：a = append(a[:i], a[j:]...)\n  为切片 a 扩展 j 个元素长度：a = append(a, make([]T, j)...)\n  在索引 i 的位置插入元素 x：a = append(a[:i], append([]T{x}, a[i:]...)...)\n  在索引 i 的位置插入长度为 j 的新切片：a = append(a[:i], append(make([]T, j), a[i:]...)...)\n  在索引 i 的位置插入切片 b 的所有元素：a = append(a[:i], append(b, a[i:]...)...)\n  取出位于切片 a 最末尾的元素 x：x, a = a[len(a)-1], a[:len(a)-1]\n  将元素 x 追加到切片 a：a = append(a, x)\n  因此，您可以使用切片和 append 操作来表示任意可变长度的序列。\n从数学的角度来看，切片相当于向量，如果需要的话可以定义一个向量作为切片的别名来进行操作。\n如果您需要更加完整的方案，可以学习一下 Eleanor McHugh 编写的几个包：slices、chain 和 lists。\n map 字典 特点\nkey-value 键值对存储\nmap是无序的\n声明方式\nvar m1 = map[int]string // 声明map 赋值会出错 m2 := map[int]string{} // 声明并初始化map 可赋值 m3 := make(map[int]string) // 等值于m2  len(m2) // 获取map数量 ~~cap(m2)~~ // 报错!!! map不能使用cap方法  赋值\nkey值相同赋值会被覆盖\n判断是否key是否存在\nm2[key] 会返回两个值，第一个是value，第二个是bool代表key是否存在\nif v, has := m2[1]; has { fmt.Println(\"value=\", v, \"has=\", has) } 删除\ndelete(m2[1])  struct 结构体 声明方式\ntype Person struct { name string age int sex byte } var man Person = Person{\"tedy\", 'm', 18} man2 := Person{name: \"tedy\", sex: 'f'} 传参方式\n默认值传递，一般不用，内存占用大，效率低\n结构体地址\n结构体指针变量的值 == 结构体首个元素的地址\n结构体指针内存模型\n强制自定义构建方法\ntype matrix struct { ... } func NewMatrix(params) *matrix { m := new(matrix) // 初始化 m  return m } package main import \"matrix\" ... wrong := new(matrix.matrix) // 编译失败（matrix 是私有的） right := matrix.NewMatrix(...) // 实例化 matrix 的唯一方式  字符串处理 // 按指定字符拆分 ret := strings.Split(str, \",\") // 按空格拆分 ret := strings.Fields(str) // 判断字符串结束标记 ret := strings.HasSuffix(\"test.txt\", \".txt\") // 判断字符串起始标记 ret := strings.HasPrefix(\"test.txt\", \"test\")  文件操作 打开文件\n// 创建文件 // 不存在则创建，存在则清空 file, err := os.Create(\"./file.txt\") if err != nil { fmt.Println(\"create file error: \", err) } defer file.Close() fmt.Println(file) // 读取文件(只读) // 不存在读取失败 file, err := os.Open(\"./file.txt\") if err != nil { fmt.Println(\"Open file error: \", err) } defer file.Close() fmt.Println(file) // 读写文件(只读/只写/读写) file, err := os.OpenFile(\"./file.txt\", os.O_CREATE|os.O_RDWR, 0755) if err != nil { fmt.Println(\"OpenFile error: \", err) } defer file.Close() fmt.Println(file) 写文件\n// 写字符串 // windows \\r\\n // linux \\n writeByte, err := file.WriteString(\"Hello world\\r\\n\") if err != nil { fmt.Println(\"WriteString error: \", err) } fmt.Println(writeByte) // 获取光标 offset, _ := file.Seek(5, io.SeekStart) fmt.Println(offset) // 指定位置写入 writeByte, err := file.WriteAt([]byte(\"1hello world\"), offset) if err != nil { fmt.Println(\"WriteAt error: \", err) } fmt.Println(writeByte) 读文件\n// 创建带有缓冲区的reader reader := bufio.NewReader(file) for { // 读取文件直到某字符 (按行读取) \treadByte, err := reader.ReadBytes('\\n') if err == io.EOF { fmt.Println(\"ReadFile finished\") break } else if err != nil { fmt.Println(\"ReadByte error: \", err) } fmt.Println(string(readByte)) }  读取文件目录 打开文件目录对象跟打开文件对象操作类似，FileMode 参数为 os.ModeDir\n通过Readdir获取到的是目录下的文件对象切片，切片内容为FileInfo接口，遍历操作即可\ntype FileInfo interface { Name() string // base name of the file \tSize() int64 // length in bytes for regular files; system-dependent for others \tMode() FileMode // file mode bits \tModTime() time.Time // modification time \tIsDir() bool // abbreviation for Mode().IsDir() \tSys() interface{} // underlying data source (can return nil) } // 读目录 dirinfo, err := os.OpenFile(\"D:\\\\www\", os.O_RDONLY, os.ModeDir) if err != nil { fmt.Println(\"OpenDifInfo error: \", err) } defer dirinfo.Close() fileInfo, err := dirinfo.Readdir(0) if err != nil { fmt.Println(\"Readdir error: \", err) } for _, info := range fileInfo { if info.IsDir() { fmt.Println(\"dir: \", info.Name()) } else { fmt.Println(\"file: \", info.Name()) } }  runtime包 Gosched()：\n出让当前goroutine所占用的CPU时间片。当再次获得CPU时，从出让位置恢复继续执行\n— 时间片轮转调度算法\nGoexit()：\nreturn：返回当前函数调用者处。return之前的defer生效\nGoexit：结束当前该goroutine调用者处。goexit之前的defer生效\nGOMAXPROCS()：\n设置当前进程使用最大CPU核数，函数返回上一次调用成功的设置值，首次调用返回默认值。\n channel 通道 定义\nchdannel是一种数据类型，先进先出（FIFO）\n// 无缓冲通道 ch := make(chan int) ch := make(chan string, 0) // 读取  ch // 写入 ch  // 读取和写入必须同时满足才能执行，否则一直阻塞等待  // 获取channel中剩余数据个数 len(ch) // 获取channel容量 cap(ch)  位运算 与运算 \u0026\nA与B位中都为true则结果为true\n1 \u0026 1 - 1 1 \u0026 0 - 0 0 \u0026 1 - 0 0 \u0026 0 - 0 或运算 |\nA与B位中任意位为true则结果为true\n1 | 1 - 1 1 | 0 - 1 0 | 1 - 1 0 | 0 - 0 异或运算 ^\nA与B位相同则为false，不同则为true\n1 ^ 1 - 0 1 ^ 0 - 1 0 ^ 1 - 1 0 ^ 0 - 0 位清除 \u0026^\nB位为true，则清零A位；B位为false，则A位保持不变；\n1 \u0026^ 1 - 0 1 \u0026^ 0 - 1 0 \u0026^ 1 - 0 0 \u0026^ 0 - 0 ",
  "wordCount" : "807",
  "inLanguage": "en",
  "datePublished": "2020-12-18T00:00:00Z",
  "dateModified": "2020-12-18T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://nicko-ch.github.io/posts/202012180000/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "\u003e $ cd /home",
    "logo": {
      "@type": "ImageObject",
      "url": "https://nicko-ch.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://nicko-ch.github.io/" accesskey="h" title="&gt; $ cd /home (Alt + H)">&gt; $ cd /home</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://nicko-ch.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://nicko-ch.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://nicko-ch.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://nicko-ch.github.io/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://nicko-ch.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://nicko-ch.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://nicko-ch.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://nicko-ch.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      Go基础语法
    </h1>
    <div class="post-meta">December 18, 2020&nbsp;·&nbsp;4 min
</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <div class="details">Table of Contents</div>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#array-%e6%95%b0%e7%bb%84" aria-label="array 数组">array 数组</a></li>
                <li>
                    <a href="#slice-%e5%88%87%e7%89%87" aria-label="slice 切片">slice 切片</a></li>
                <li>
                    <a href="#%e6%95%b0%e7%bb%84%e4%b8%8e%e5%88%87%e7%89%87%e5%ae%9a%e4%b9%89%e5%8c%ba%e5%88%ab" aria-label="数组与切片定义区别">数组与切片定义区别</a></li>
                <li>
                    <a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e4%b8%8e%e5%88%87%e7%89%87" aria-label="字符串与切片">字符串与切片</a></li>
                <li>
                    <a href="#append%e5%87%bd%e6%95%b0%e5%b8%b8%e7%94%a8%e6%93%8d%e4%bd%9c" aria-label="append函数常用操作">append函数常用操作</a></li>
                <li>
                    <a href="#map-%e5%ad%97%e5%85%b8" aria-label="map 字典">map 字典</a></li>
                <li>
                    <a href="#struct-%e7%bb%93%e6%9e%84%e4%bd%93" aria-label="struct 结构体">struct 结构体</a></li>
                <li>
                    <a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%a4%84%e7%90%86" aria-label="字符串处理">字符串处理</a></li>
                <li>
                    <a href="#%e6%96%87%e4%bb%b6%e6%93%8d%e4%bd%9c" aria-label="文件操作">文件操作</a></li>
                <li>
                    <a href="#%e8%af%bb%e5%8f%96%e6%96%87%e4%bb%b6%e7%9b%ae%e5%bd%95" aria-label="读取文件目录">读取文件目录</a></li>
                <li>
                    <a href="#runtime%e5%8c%85" aria-label="runtime包">runtime包</a></li>
                <li>
                    <a href="#channel-%e9%80%9a%e9%81%93" aria-label="channel 通道">channel 通道</a></li>
                <li>
                    <a href="#%e4%bd%8d%e8%bf%90%e7%ae%97" aria-label="位运算">位运算</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="array-数组">array 数组<a hidden class="anchor" aria-hidden="true" href="#array-数组">#</a></h2>
<p>声明方式</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">identifier</span> [<span style="color:#a6e22e">len</span>]<span style="color:#66d9ef">type</span>  <span style="color:#75715e">// var arr [5]int
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">arrAge</span> = [<span style="color:#ae81ff">5</span>]<span style="color:#66d9ef">int</span>{<span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">16</span>}  <span style="color:#75715e">// 声明容量为5的数组并初始化
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">arrLazy</span> = [<span style="color:#f92672">...</span>]<span style="color:#66d9ef">int</span>{<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">22</span>}  <span style="color:#75715e">// 初始化数组自动计算容量（实际上已是切片）
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">arrLazy</span> = []<span style="color:#66d9ef">int</span>{<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">22</span>}	 <span style="color:#75715e">//  初始化得到的实际上是切片slice
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">arrKeyValue</span> = [<span style="color:#ae81ff">5</span>]<span style="color:#66d9ef">string</span>{<span style="color:#ae81ff">3</span>: <span style="color:#e6db74">&#34;Chris&#34;</span>, <span style="color:#ae81ff">4</span>: <span style="color:#e6db74">&#34;Ron&#34;</span>} <span style="color:#75715e">//  0,1,2 都未空值
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">arrKeyValue</span> = []<span style="color:#66d9ef">string</span>{<span style="color:#ae81ff">3</span>: <span style="color:#e6db74">&#34;Chris&#34;</span>, <span style="color:#ae81ff">4</span>: <span style="color:#e6db74">&#34;Ron&#34;</span>}	<span style="color:#75715e">//  初始化得到的实际上是切片slice
</span></code></pre></div><hr>
<h2 id="slice-切片">slice 切片<a hidden class="anchor" aria-hidden="true" href="#slice-切片">#</a></h2>
<p>本质</p>
<p>不是一组数组的指针，是一种数据结构，用来操作内部元素。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#a6e22e">切片名称</span> [<span style="color:#a6e22e">low</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">high</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">max</span>]
<span style="color:#a6e22e">low</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">起始下标位置</span>
<span style="color:#a6e22e">high</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">结束下标位置</span> <span style="color:#a6e22e">len</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">high</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">low</span>
<span style="color:#a6e22e">max</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">容量</span> <span style="color:#a6e22e">cap</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">max</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">low</span>
</code></pre></div><p>声明方式</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">slice</span> []<span style="color:#66d9ef">type</span> = <span style="color:#a6e22e">arr</span>[<span style="color:#a6e22e">start</span>:<span style="color:#a6e22e">end</span>]  <span style="color:#75715e">// 已存在arr数组时
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">slice</span> []<span style="color:#66d9ef">type</span> = make([]<span style="color:#66d9ef">type</span>, <span style="color:#a6e22e">len</span>)  <span style="color:#75715e">// 未生成数组时用make声明
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">slice1</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">type</span>, <span style="color:#a6e22e">len</span>) <span style="color:#75715e">// 同上，简写
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">s2</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">int</span>, <span style="color:#ae81ff">10</span>) <span style="color:#75715e">// cap(s2) == len(s2) == 10
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// make 函数参数
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> make([]<span style="color:#a6e22e">T</span>, <span style="color:#a6e22e">len</span>, <span style="color:#a6e22e">cap</span>)
</code></pre></div><p>基本元素</p>
<p><img loading="lazy" src="/../static/images/202012180000/Untitled.png" alt="../static/images/202012180000/Untitled.png"  />
</p>
<hr>
<h2 id="数组与切片定义区别">数组与切片定义区别<a hidden class="anchor" aria-hidden="true" href="#数组与切片定义区别">#</a></h2>
<blockquote>
<p>创建数组时 <code>[n]</code> 指定数组长度
创建切片时 <code>[]</code> 为<code>空</code>，或者<code>...</code></p>
</blockquote>
<hr>
<h2 id="字符串与切片">字符串与切片<a hidden class="anchor" aria-hidden="true" href="#字符串与切片">#</a></h2>
<p>内存结构</p>
<p><img loading="lazy" src="/../static/images/202012180000/Untitled1.png" alt="../static/images/202012180000/Untitled1.png"  />
</p>
<p>修改字符串中的某个字符</p>
<p>例如，将字符串 &ldquo;hello&rdquo; 转换为 &ldquo;cello&rdquo;：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">s</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;hello&#34;</span>
<span style="color:#a6e22e">c</span> <span style="color:#f92672">:=</span> []byte(<span style="color:#a6e22e">s</span>)
<span style="color:#a6e22e">c</span>[<span style="color:#ae81ff">0</span>] = <span style="color:#e6db74">&#39;c&#39;</span>
<span style="color:#a6e22e">s2</span> <span style="color:#f92672">:=</span> string(<span style="color:#a6e22e">c</span>) <span style="color:#75715e">// s2 == &#34;cello&#34;
</span></code></pre></div><hr>
<h2 id="append函数常用操作">append函数常用操作<a hidden class="anchor" aria-hidden="true" href="#append函数常用操作">#</a></h2>
<p>我们在第 7.5 节提到的 append 非常有用，它能够用于各种方面的操作：</p>
<ol>
<li>
<p>将切片 b 的元素追加到切片 a 之后：<code>a = append(a, b...)</code></p>
</li>
<li>
<p>复制切片 a 的元素到新的切片 b 上：</p>
<p><code>b = make([]T, len(a)) copy(b, a)</code></p>
</li>
<li>
<p>删除位于索引 i 的元素：<code>a = append(a[:i], a[i+1:]...)</code></p>
</li>
<li>
<p>切除切片 a 中从索引 i 至 j 位置的元素：<code>a = append(a[:i], a[j:]...)</code></p>
</li>
<li>
<p>为切片 a 扩展 j 个元素长度：<code>a = append(a, make([]T, j)...)</code></p>
</li>
<li>
<p>在索引 i 的位置插入元素 x：<code>a = append(a[:i], append([]T{x}, a[i:]...)...)</code></p>
</li>
<li>
<p>在索引 i 的位置插入长度为 j 的新切片：<code>a = append(a[:i], append(make([]T, j), a[i:]...)...)</code></p>
</li>
<li>
<p>在索引 i 的位置插入切片 b 的所有元素：<code>a = append(a[:i], append(b, a[i:]...)...)</code></p>
</li>
<li>
<p>取出位于切片 a 最末尾的元素 x：<code>x, a = a[len(a)-1], a[:len(a)-1]</code></p>
</li>
<li>
<p>将元素 x 追加到切片 a：<code>a = append(a, x)</code></p>
</li>
</ol>
<p>因此，您可以使用切片和 append 操作来表示任意可变长度的序列。</p>
<p>从数学的角度来看，切片相当于向量，如果需要的话可以定义一个向量作为切片的别名来进行操作。</p>
<p>如果您需要更加完整的方案，可以学习一下 Eleanor McHugh 编写的几个包：<a href="http://github.com/feyeleanor/slices">slices</a>、<a href="http://github.com/feyeleanor/chain">chain</a> 和 <a href="http://github.com/feyeleanor/lists">lists</a>。</p>
<hr>
<h2 id="map-字典">map 字典<a hidden class="anchor" aria-hidden="true" href="#map-字典">#</a></h2>
<p>特点</p>
<p>key-value 键值对存储</p>
<p>map是无序的</p>
<p>声明方式</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">m1</span> = <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">int</span>]<span style="color:#66d9ef">string</span> <span style="color:#75715e">// 声明map 赋值会出错
</span><span style="color:#75715e"></span><span style="color:#a6e22e">m2</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">int</span>]<span style="color:#66d9ef">string</span>{} <span style="color:#75715e">// 声明并初始化map 可赋值
</span><span style="color:#75715e"></span><span style="color:#a6e22e">m3</span> <span style="color:#f92672">:=</span> make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">int</span>]<span style="color:#66d9ef">string</span>) <span style="color:#75715e">// 等值于m2
</span><span style="color:#75715e"></span>
len(<span style="color:#a6e22e">m2</span>) <span style="color:#75715e">// 获取map数量 
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">~~</span>cap(<span style="color:#a6e22e">m2</span>)<span style="color:#960050;background-color:#1e0010">~~</span> <span style="color:#75715e">// 报错!!! map不能使用cap方法
</span><span style="color:#75715e"></span>
</code></pre></div><p>赋值</p>
<p>key值相同赋值会被覆盖</p>
<p>判断是否key是否存在</p>
<p>m2[key] 会返回两个值，第一个是value，第二个是bool代表key是否存在</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">v</span>, <span style="color:#a6e22e">has</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">m2</span>[<span style="color:#ae81ff">1</span>]; <span style="color:#a6e22e">has</span> {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;value=&#34;</span>, <span style="color:#a6e22e">v</span>, <span style="color:#e6db74">&#34;has=&#34;</span>, <span style="color:#a6e22e">has</span>)
}
</code></pre></div><p>删除</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">delete(<span style="color:#a6e22e">m2</span>[<span style="color:#ae81ff">1</span>])
</code></pre></div><hr>
<h2 id="struct-结构体">struct 结构体<a hidden class="anchor" aria-hidden="true" href="#struct-结构体">#</a></h2>
<p>声明方式</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Person</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">age</span> <span style="color:#66d9ef">int</span>
	<span style="color:#a6e22e">sex</span> <span style="color:#66d9ef">byte</span>
}

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">man</span> <span style="color:#a6e22e">Person</span> = <span style="color:#a6e22e">Person</span>{<span style="color:#e6db74">&#34;tedy&#34;</span>, <span style="color:#e6db74">&#39;m&#39;</span>, <span style="color:#ae81ff">18</span>}
<span style="color:#a6e22e">man2</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Person</span>{<span style="color:#a6e22e">name</span>: <span style="color:#e6db74">&#34;tedy&#34;</span>, <span style="color:#a6e22e">sex</span>: <span style="color:#e6db74">&#39;f&#39;</span>}
</code></pre></div><p>传参方式</p>
<p>默认值传递，一般不用，内存占用大，效率低</p>
<p>结构体地址</p>
<p>结构体指针变量的值 == 结构体首个元素的地址</p>
<p><img loading="lazy" src="/../static/images/202012180000/Untitled2.png" alt="../static/images/202012180000/Untitled2.png"  />
</p>
<p>结构体指针内存模型</p>
<p><img loading="lazy" src="/../static/images/202012180000/Untitled3.png" alt="../static/images/202012180000/Untitled3.png"  />
</p>
<p>强制自定义构建方法</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">matrix</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#f92672">...</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewMatrix</span>(<span style="color:#a6e22e">params</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">matrix</span> {
    <span style="color:#a6e22e">m</span> <span style="color:#f92672">:=</span> new(<span style="color:#a6e22e">matrix</span>) <span style="color:#75715e">// 初始化 m
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">m</span>
}

<span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;matrix&#34;</span>
<span style="color:#f92672">...</span>
<span style="color:#a6e22e">wrong</span> <span style="color:#f92672">:=</span> new(<span style="color:#a6e22e">matrix</span>.<span style="color:#a6e22e">matrix</span>)     <span style="color:#75715e">// 编译失败（matrix 是私有的）
</span><span style="color:#75715e"></span><span style="color:#a6e22e">right</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">matrix</span>.<span style="color:#a6e22e">NewMatrix</span>(<span style="color:#f92672">...</span>)  <span style="color:#75715e">// 实例化 matrix 的唯一方式
</span></code></pre></div><hr>
<h2 id="字符串处理">字符串处理<a hidden class="anchor" aria-hidden="true" href="#字符串处理">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// 按指定字符拆分
</span><span style="color:#75715e"></span><span style="color:#a6e22e">ret</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">Split</span>(<span style="color:#a6e22e">str</span>, <span style="color:#e6db74">&#34;,&#34;</span>)
<span style="color:#75715e">// 按空格拆分
</span><span style="color:#75715e"></span><span style="color:#a6e22e">ret</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">Fields</span>(<span style="color:#a6e22e">str</span>)
<span style="color:#75715e">// 判断字符串结束标记
</span><span style="color:#75715e"></span><span style="color:#a6e22e">ret</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">HasSuffix</span>(<span style="color:#e6db74">&#34;test.txt&#34;</span>, <span style="color:#e6db74">&#34;.txt&#34;</span>)
<span style="color:#75715e">// 判断字符串起始标记
</span><span style="color:#75715e"></span><span style="color:#a6e22e">ret</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">HasPrefix</span>(<span style="color:#e6db74">&#34;test.txt&#34;</span>, <span style="color:#e6db74">&#34;test&#34;</span>)
</code></pre></div><hr>
<h2 id="文件操作">文件操作<a hidden class="anchor" aria-hidden="true" href="#文件操作">#</a></h2>
<p>打开文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// 创建文件
</span><span style="color:#75715e">// 不存在则创建，存在则清空
</span><span style="color:#75715e"></span><span style="color:#a6e22e">file</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Create</span>(<span style="color:#e6db74">&#34;./file.txt&#34;</span>)
<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;create file error: &#34;</span>, <span style="color:#a6e22e">err</span>)
}
<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Close</span>()
<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">file</span>)

<span style="color:#75715e">// 读取文件(只读)
</span><span style="color:#75715e">// 不存在读取失败
</span><span style="color:#75715e"></span><span style="color:#a6e22e">file</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#e6db74">&#34;./file.txt&#34;</span>)
<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Open file error: &#34;</span>, <span style="color:#a6e22e">err</span>)
}
<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Close</span>()
<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">file</span>)

<span style="color:#75715e">// 读写文件(只读/只写/读写)
</span><span style="color:#75715e"></span><span style="color:#a6e22e">file</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">OpenFile</span>(<span style="color:#e6db74">&#34;./file.txt&#34;</span>, <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">O_CREATE</span>|<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">O_RDWR</span>, <span style="color:#ae81ff">0755</span>)
<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;OpenFile error: &#34;</span>, <span style="color:#a6e22e">err</span>)
}
<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Close</span>()
<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">file</span>)
</code></pre></div><p>写文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// 写字符串 
</span><span style="color:#75715e">// windows \r\n 
</span><span style="color:#75715e">// linux \n
</span><span style="color:#75715e"></span><span style="color:#a6e22e">writeByte</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">WriteString</span>(<span style="color:#e6db74">&#34;Hello world\r\n&#34;</span>)
<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;WriteString error: &#34;</span>, <span style="color:#a6e22e">err</span>)
}
<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">writeByte</span>)

<span style="color:#75715e">// 获取光标
</span><span style="color:#75715e"></span><span style="color:#a6e22e">offset</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Seek</span>(<span style="color:#ae81ff">5</span>, <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">SeekStart</span>)
<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">offset</span>)

<span style="color:#75715e">// 指定位置写入
</span><span style="color:#75715e"></span><span style="color:#a6e22e">writeByte</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">WriteAt</span>([]byte(<span style="color:#e6db74">&#34;1hello world&#34;</span>), <span style="color:#a6e22e">offset</span>)
<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;WriteAt error: &#34;</span>, <span style="color:#a6e22e">err</span>)
}
<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">writeByte</span>)
</code></pre></div><p>读文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// 创建带有缓冲区的reader
</span><span style="color:#75715e"></span><span style="color:#a6e22e">reader</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">bufio</span>.<span style="color:#a6e22e">NewReader</span>(<span style="color:#a6e22e">file</span>)
<span style="color:#66d9ef">for</span> {
  <span style="color:#75715e">// 读取文件直到某字符 (按行读取)
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">readByte</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">reader</span>.<span style="color:#a6e22e">ReadBytes</span>(<span style="color:#e6db74">&#39;\n&#39;</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">EOF</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;ReadFile finished&#34;</span>)
		<span style="color:#66d9ef">break</span>
	} <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;ReadByte error: &#34;</span>, <span style="color:#a6e22e">err</span>)
	}
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(string(<span style="color:#a6e22e">readByte</span>))
}
</code></pre></div><hr>
<h2 id="读取文件目录">读取文件目录<a hidden class="anchor" aria-hidden="true" href="#读取文件目录">#</a></h2>
<p>打开文件目录对象跟打开文件对象操作类似，<code>FileMode</code> 参数为 <code>os.ModeDir</code></p>
<p>通过<code>Readdir</code>获取到的是目录下的文件对象切片，切片内容为<code>FileInfo</code>接口，遍历操作即可</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">FileInfo</span> <span style="color:#66d9ef">interface</span> {
	<span style="color:#a6e22e">Name</span>() <span style="color:#66d9ef">string</span>       <span style="color:#75715e">// base name of the file
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Size</span>() <span style="color:#66d9ef">int64</span>        <span style="color:#75715e">// length in bytes for regular files; system-dependent for others
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Mode</span>() <span style="color:#a6e22e">FileMode</span>     <span style="color:#75715e">// file mode bits
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">ModTime</span>() <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span> <span style="color:#75715e">// modification time
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">IsDir</span>() <span style="color:#66d9ef">bool</span>        <span style="color:#75715e">// abbreviation for Mode().IsDir()
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Sys</span>() <span style="color:#66d9ef">interface</span>{}   <span style="color:#75715e">// underlying data source (can return nil)
</span><span style="color:#75715e"></span>}

<span style="color:#75715e">// 读目录
</span><span style="color:#75715e"></span><span style="color:#a6e22e">dirinfo</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">OpenFile</span>(<span style="color:#e6db74">&#34;D:\\www&#34;</span>, <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">O_RDONLY</span>, <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">ModeDir</span>)
<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;OpenDifInfo error: &#34;</span>, <span style="color:#a6e22e">err</span>)
}
<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">dirinfo</span>.<span style="color:#a6e22e">Close</span>()

<span style="color:#a6e22e">fileInfo</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">dirinfo</span>.<span style="color:#a6e22e">Readdir</span>(<span style="color:#ae81ff">0</span>)
<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Readdir error: &#34;</span>, <span style="color:#a6e22e">err</span>)
}

<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">info</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">fileInfo</span> {
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">info</span>.<span style="color:#a6e22e">IsDir</span>() {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;dir: &#34;</span>, <span style="color:#a6e22e">info</span>.<span style="color:#a6e22e">Name</span>())
	} <span style="color:#66d9ef">else</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;file: &#34;</span>, <span style="color:#a6e22e">info</span>.<span style="color:#a6e22e">Name</span>())
	}
}
</code></pre></div><hr>
<h2 id="runtime包">runtime包<a hidden class="anchor" aria-hidden="true" href="#runtime包">#</a></h2>
<p>Gosched()：</p>
<p>出让当前goroutine所占用的CPU时间片。当再次获得CPU时，从出让位置恢复继续执行</p>
<p>— 时间片轮转调度算法</p>
<p>Goexit()：</p>
<p>return：返回当前函数调用者处。return之前的defer生效</p>
<p>Goexit：结束当前该goroutine调用者处。goexit之前的defer生效</p>
<p>GOMAXPROCS()：</p>
<p>设置当前进程使用最大CPU核数，函数返回上一次调用成功的设置值，首次调用返回默认值。</p>
<hr>
<h2 id="channel-通道">channel 通道<a hidden class="anchor" aria-hidden="true" href="#channel-通道">#</a></h2>
<p>定义</p>
<p>chdannel是一种数据类型，先进先出（FIFO）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// 无缓冲通道
</span><span style="color:#75715e"></span><span style="color:#a6e22e">ch</span> <span style="color:#f92672">:=</span> make(<span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">int</span>)
<span style="color:#a6e22e">ch</span> <span style="color:#f92672">:=</span> make(<span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">string</span>, <span style="color:#ae81ff">0</span>)

<span style="color:#75715e">// 读取
</span><span style="color:#75715e"></span><span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ch</span>

<span style="color:#75715e">// 写入
</span><span style="color:#75715e"></span><span style="color:#a6e22e">ch</span> <span style="color:#f92672">&lt;-</span>

<span style="color:#75715e">// 读取和写入必须同时满足才能执行，否则一直阻塞等待
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// 获取channel中剩余数据个数
</span><span style="color:#75715e"></span>len(<span style="color:#a6e22e">ch</span>)

<span style="color:#75715e">// 获取channel容量
</span><span style="color:#75715e"></span>cap(<span style="color:#a6e22e">ch</span>)
</code></pre></div><hr>
<h2 id="位运算">位运算<a hidden class="anchor" aria-hidden="true" href="#位运算">#</a></h2>
<p>与运算 &amp;</p>
<p>A与B位中<code>都</code>为<code>true</code>则结果为<code>true</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">0</span>
</code></pre></div><p>或运算 |</p>
<p>A与B位中<code>任意位</code>为<code>true</code>则结果为<code>true</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#ae81ff">1</span> | <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">1</span> | <span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">0</span> | <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">0</span> | <span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">0</span>
</code></pre></div><p>异或运算 ^</p>
<p>A与B位<code>相同</code>则为<code>false</code>，<code>不同</code>则为<code>true</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#ae81ff">1</span> ^ <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">1</span> ^ <span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">0</span> ^ <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">0</span> ^ <span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">0</span>
</code></pre></div><p>位清除 &amp;^</p>
<p>B位为<code>true</code>，则<code>清零</code>A位；B位为<code>false</code>，则A位保持<code>不变</code>；</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;^</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;^</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;^</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;^</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">-</span>&gt; <span style="color:#ae81ff">0</span>
</code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://nicko-ch.github.io/tags/go/">Go</a></li>
    </ul>
  </footer>
</article>
    </main>
    <footer class="footer">
    <span>&copy; 2022 <a href="https://nicko-ch.github.io/">&gt; $ cd /home</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
